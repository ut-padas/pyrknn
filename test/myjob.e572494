
Currently Loaded Modules:
  1) git/2.24.1      4) pmix/3.1.4      7) TACC              10) ucx/1.6.1
  2) autotools/1.2   5) hwloc/1.11.12   8) intel/19.0.5      11) impi/19.0.5
  3) cmake/3.16.1    6) xalt/2.7.28     9) cuda/10.1    (g)  12) python3/3.7.0

  Where:
   g:  built for GPU

 

Traceback (most recent call last):
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/typing/context.py", line 358, in resolve_argument_type
    return typeof(val, Purpose.argument)
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/typing/typeof.py", line 34, in typeof
    raise ValueError(msg)
ValueError: cannot determine Numba type of <class 'cupy.core.core.ndarray'>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/cuda/cudadrv/driver.py", line 231, in initialize
    self.cuInit(0)
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/cuda/cudadrv/driver.py", line 294, in safe_cuda_api_call
    self._check_error(fname, retcode)
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/cuda/cudadrv/driver.py", line 329, in _check_error
    raise CudaAPIError(retcode, msg)
numba.cuda.cudadrv.driver.CudaAPIError: [-1] Call to cuInit results in UNKNOWN_CUDA_ERROR

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "cupy_test.py", line 25, in <module>
    add[1, 32](a, b, out)
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/cuda/compiler.py", line 804, in __call__
    kernel = self.specialize(*args)
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/cuda/compiler.py", line 814, in specialize
    [self.typingctx.resolve_argument_type(a) for a in args])
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/cuda/compiler.py", line 814, in <listcomp>
    [self.typingctx.resolve_argument_type(a) for a in args])
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/typing/context.py", line 361, in resolve_argument_type
    return typeof(numba.cuda.as_cuda_array(val), Purpose.argument)
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/cuda/api.py", line 68, in as_cuda_array
    owner=obj)
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/cuda/cudadrv/devices.py", line 224, in _require_cuda_context
    with _runtime.ensure_context():
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/contextlib.py", line 112, in __enter__
    return next(self.gen)
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/cuda/cudadrv/devices.py", line 122, in ensure_context
    with driver.get_active_context():
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/cuda/cudadrv/driver.py", line 387, in __enter__
    driver.cuCtxGetCurrent(byref(hctx))
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/cuda/cudadrv/driver.py", line 274, in __getattr__
    self.initialize()
  File "/work/06081/wlruys/anaconda3/envs/hongru/lib/python3.7/site-packages/numba/cuda/cudadrv/driver.py", line 234, in initialize
    raise CudaSupportError("Error at driver init: \n%s:" % e)
numba.cuda.cudadrv.error.CudaSupportError: Error at driver init: 
[-1] Call to cuInit results in UNKNOWN_CUDA_ERROR:
